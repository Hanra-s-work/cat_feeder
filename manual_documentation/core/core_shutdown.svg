<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="505px" preserveAspectRatio="none" style="width:872px;height:505px;background:#FFFFFF;" version="1.1" viewBox="0 0 872 505" width="872px" zoomAndPan="magnify"><defs/><g><g><title>RuntimeControl</title><rect fill="#FFFFFF" height="71.2656" style="stroke:#000000;stroke-width:1;" width="10" x="202.4785" y="71.4297"/></g><g><title>RuntimeManager</title><rect fill="#FFFFFF" height="29.1328" style="stroke:#000000;stroke-width:1;" width="10" x="373.9307" y="171.8281"/></g><g><title>Services</title><rect fill="#FFFFFF" height="94.5313" style="stroke:#000000;stroke-width:1;" width="10" x="509.6831" y="254.2266"/></g><rect fill="#FFFFFF" height="140.7969" style="stroke:#000000;stroke-width:1;" width="851.7964" x="15" y="215.9609"/><g><title>Server</title><rect fill="#000000" fill-opacity="0.00000" height="425.8594" width="8" x="60.9551" y="40.2969"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:5,5;" x1="64" x2="64" y1="40.2969" y2="466.1563"/></g><g><title>RuntimeControl</title><rect fill="#000000" fill-opacity="0.00000" height="425.8594" width="8" x="203.4785" y="40.2969"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:5,5;" x1="207.4697" x2="207.4697" y1="40.2969" y2="466.1563"/></g><g><title>RuntimeManager</title><rect fill="#000000" fill-opacity="0.00000" height="425.8594" width="8" x="374.9307" y="40.2969"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:5,5;" x1="378.6958" x2="378.6958" y1="40.2969" y2="466.1563"/></g><g><title>Services</title><rect fill="#000000" fill-opacity="0.00000" height="425.8594" width="8" x="510.6831" y="40.2969"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:5,5;" x1="514.1655" x2="514.1655" y1="40.2969" y2="466.1563"/></g><g class="participant participant-head" data-participant="Server"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="59.9102" x="35" y="9"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="45.9102" x="42" y="28.9951">Server</text></g><g class="participant participant-tail" data-participant="Server"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="59.9102" x="35" y="465.1563"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="45.9102" x="42" y="485.1514">Server</text></g><g class="participant participant-head" data-participant="RC"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="124.0176" x="145.4697" y="9"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="110.0176" x="152.4697" y="28.9951">RuntimeControl</text></g><g class="participant participant-tail" data-participant="RC"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="124.0176" x="145.4697" y="465.1563"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="110.0176" x="152.4697" y="485.1514">RuntimeControl</text></g><g class="participant participant-head" data-participant="RM"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="134.4697" x="311.6958" y="9"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="120.4697" x="318.6958" y="28.9951">RuntimeManager</text></g><g class="participant participant-tail" data-participant="RM"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="134.4697" x="311.6958" y="465.1563"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="120.4697" x="318.6958" y="485.1514">RuntimeManager</text></g><g class="participant participant-head" data-participant="Services"><rect fill="#FFFFFF" height="30.2969" style="stroke:#000000;stroke-width:1;" width="73.0352" x="480.1655" y="5"/><rect fill="#FFFFFF" height="30.2969" style="stroke:#000000;stroke-width:1;" width="73.0352" x="476.1655" y="9"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="59.0352" x="483.1655" y="28.9951">Services</text></g><g class="participant participant-tail" data-participant="Services"><rect fill="#FFFFFF" height="30.2969" style="stroke:#000000;stroke-width:1;" width="73.0352" x="480.1655" y="465.1563"/><rect fill="#FFFFFF" height="30.2969" style="stroke:#000000;stroke-width:1;" width="73.0352" x="476.1655" y="469.1563"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="59.0352" x="483.1655" y="489.1514">Services</text></g><g><title>RuntimeControl</title><rect fill="#FFFFFF" height="71.2656" style="stroke:#000000;stroke-width:1;" width="10" x="202.4785" y="71.4297"/></g><g><title>RuntimeManager</title><rect fill="#FFFFFF" height="29.1328" style="stroke:#000000;stroke-width:1;" width="10" x="373.9307" y="171.8281"/></g><g><title>Services</title><rect fill="#FFFFFF" height="94.5313" style="stroke:#000000;stroke-width:1;" width="10" x="509.6831" y="254.2266"/></g><g class="message" data-participant-1="Server" data-participant-2="RC"><polygon fill="#000000" points="190.4785,67.4297,200.4785,71.4297,190.4785,75.4297,194.4785,71.4297" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="64.9551" x2="196.4785" y1="71.4297" y2="71.4297"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="118.5234" x="71.9551" y="66.3638">signal_shutdown()</text></g><g class="message" data-participant-1="RC" data-participant-2="RC"><line style="stroke:#000000;stroke-width:1;" x1="212.4785" x2="254.4785" y1="100.5625" y2="100.5625"/><line style="stroke:#000000;stroke-width:1;" x1="254.4785" x2="254.4785" y1="100.5625" y2="113.5625"/><line style="stroke:#000000;stroke-width:1;" x1="213.4785" x2="254.4785" y1="113.5625" y2="113.5625"/><polygon fill="#000000" points="223.4785,109.5625,213.4785,113.5625,223.4785,117.5625,219.4785,113.5625" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="137.4521" x="219.4785" y="95.4966">set _shutdown_event</text></g><path d="M378.4521,87.9297 L378.4521,112.9297 L550.4521,112.9297 L550.4521,97.9297 L540.4521,87.9297 L378.4521,87.9297" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><path d="M540.4521,87.9297 L540.4521,97.9297 L550.4521,97.9297 L540.4521,87.9297" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="151.6138" x="384.4521" y="104.9966">Global shutdown signal</text><g class="message" data-participant-1="RC" data-participant-2="Server"><polygon fill="#000000" points="75.9551,138.6953,65.9551,142.6953,75.9551,146.6953,71.9551,142.6953" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="69.9551" x2="206.4785" y1="142.6953" y2="142.6953"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="93.8311" x="81.9551" y="137.6294">acknowledged</text></g><g class="message" data-participant-1="Server" data-participant-2="RM"><polygon fill="#000000" points="361.9307,167.8281,371.9307,171.8281,361.9307,175.8281,365.9307,171.8281" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="64.9551" x2="367.9307" y1="171.8281" y2="171.8281"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="121.5259" x="71.9551" y="166.7622">get_all_instances()</text></g><g class="message" data-participant-1="RM" data-participant-2="Server"><polygon fill="#000000" points="75.9551,196.9609,65.9551,200.9609,75.9551,204.9609,71.9551,200.9609" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="69.9551" x2="377.9307" y1="200.9609" y2="200.9609"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="148.7446" x="81.9551" y="195.895">[service1, service2, ...]</text></g><path d="M15,215.9609 L91.624,215.9609 L91.624,223.0938 L81.624,233.0938 L15,233.0938 L15,215.9609" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><rect fill="none" height="140.7969" style="stroke:#000000;stroke-width:1;" width="851.7964" x="15" y="215.9609"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="31.624" x="30" y="229.0278">loop</text><text fill="#000000" font-family="Verdana" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="109.0708" x="106.624" y="228.1714">[for each service]</text><g class="message" data-participant-1="Server" data-participant-2="Services"><polygon fill="#000000" points="497.6831,250.2266,507.6831,254.2266,497.6831,258.2266,501.6831,254.2266" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="64.9551" x2="503.6831" y1="254.2266" y2="254.2266"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="73.5693" x="71.9551" y="249.1606">shutdown()</text></g><g class="message" data-participant-1="Services" data-participant-2="Services"><line style="stroke:#000000;stroke-width:1;" x1="519.6831" x2="561.6831" y1="294.9922" y2="294.9922"/><line style="stroke:#000000;stroke-width:1;" x1="561.6831" x2="561.6831" y1="294.9922" y2="307.9922"/><line style="stroke:#000000;stroke-width:1;" x1="520.6831" x2="561.6831" y1="307.9922" y2="307.9922"/><polygon fill="#000000" points="530.6831,303.9922,520.6831,307.9922,530.6831,311.9922,526.6831,307.9922" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="119.1582" x="526.6831" y="289.9263">cleanup resources</text></g><path d="M667.1582,267.2266 L667.1582,322.2266 L845.1582,322.2266 L845.1582,277.2266 L835.1582,267.2266 L667.1582,267.2266" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><path d="M835.1582,267.2266 L835.1582,277.2266 L845.1582,277.2266 L835.1582,267.2266" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="126.769" x="673.1582" y="284.2935">- Close connections</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="92.5679" x="673.1582" y="299.4263">- Flush caches</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="157.9551" x="673.1582" y="314.5591">- Stop background tasks</text><g class="message" data-participant-1="Services" data-participant-2="Server"><polygon fill="#000000" points="75.9551,344.7578,65.9551,348.7578,75.9551,352.7578,71.9551,348.7578" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="69.9551" x2="513.6831" y1="348.7578" y2="348.7578"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="68.9736" x="81.9551" y="343.6919">completed</text></g><g class="message" data-participant-1="Server" data-participant-2="Server"><line style="stroke:#000000;stroke-width:1;" x1="64.9551" x2="106.9551" y1="384.8906" y2="384.8906"/><line style="stroke:#000000;stroke-width:1;" x1="106.9551" x2="106.9551" y1="384.8906" y2="397.8906"/><line style="stroke:#000000;stroke-width:1;" x1="65.9551" x2="106.9551" y1="397.8906" y2="397.8906"/><polygon fill="#000000" points="75.9551,393.8906,65.9551,397.8906,75.9551,401.8906,71.9551,397.8906" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="92.9741" x="71.9551" y="379.8247">exit gracefully</text></g><path d="M23,410.8906 L23,450.8906 L556,450.8906 L556,420.8906 L546,410.8906 L23,410.8906" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><path d="M546,410.8906 L546,420.8906 L556,420.8906 L546,410.8906" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="357.0747" x="106.563" y="427.9575">Services can check RuntimeControl.is_shutting_down()</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="196.187" x="106.563" y="443.0903">during execution to stop early</text><!--SRC=[TLAnRjmm3Dtr5Moc5hWSa8uUkXpGJbwSiGWCHcPiuNIa8L6NzkyhdS-ENBIQHEdnFVAHdtIY2y7iqR4nCmPrrit82W_F5AuK7W0ZBDVzTvTOtOLEmXh4ts3TwP-G5Xd7ErFN6YlUarKd71SHPobkCYKmPX64ns-Piu7eHaRVnodf8E_y-Ol1d7z5fIBPdJOSAMoedgx4QbWoAhXnqWP-U7b53olYpdiZo0oBPWDepopldeQH1ZDGBLNNrJOmalReVUyuAd8kV5TPQxfsH_mpBlqz7U1- -tg0u_7uibDfZV4YCxn9WFmyhLW3-NpehrurKDbI81lJvkQQM89zglM4d6O852M55VjXsIqivn5ENYA15URxxAg_xpx52MmkbkhdPyrjl6Oxno291r2Cv-MVSbHK_YgjyihAPVQaUG85KlcpTPKvwdciYVJBAOm1BRqbxt-RPG6ae1R8uJ_6M6J83TWpx3VxwE9jfzJns5S-3odabwn7DXL3G0LYwPWmPDsjnJy0]--></g></svg>