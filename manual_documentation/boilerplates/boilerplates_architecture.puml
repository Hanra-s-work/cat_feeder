' 
' +==== BEGIN AsperBackend =================+
' LOGO: 
' ..........####...####..........
' ......###.....#.#########......
' ....##........#.###########....
' ...#..........#.############...
' ...#..........#.#####.######...
' ..#.....##....#.###..#...####..
' .#.....#.##...#.##..##########.
' #.....##########....##...######
' #.....#...##..#.##..####.######
' .#...##....##.#.##..###..#####.
' ..#.##......#.#.####...######..
' ..#...........#.#############..
' ..#...........#.#############..
' ...##.........#.############...
' ......#.......#.#########......
' .......#......#.########.......
' .........#####...#####.........
' /STOP
' PROJECT: AsperBackend
' FILE: boilerplates_architecture.puml
' CREATION DATE: 02-12-2025
' LAST Modified: 15:30:7 02-12-2025
' DESCRIPTION: 
' This is the backend server in charge of making the actual website work.
' /STOP
' COPYRIGHT: (c) Asperguide
' PURPOSE: The architectural overview of the boilerplate classes.
' // AR
' +==== END AsperBackend =================+
' 
@startuml boilerplates_architecture
!theme plain

package "Boilerplates Module" {
  class BoilerplateResponses {
    - server_headers_initialised: ServerHeaders
    - boilerplate_non_http_initialised: BoilerplateNonHTTP
    - runtime_manager: RuntimeManager
    + __init__(debug)
    + build_response_body(title, message, resp, token, error)
    + invalid_token(title)
    + no_access_token(title, token)
    + not_logged_in(title)
    + login_failed(title)
    + insuffisant_rights(title, token)
    + bad_request(title, token)
    + internal_server_error(title, token)
    + unauthorized(title, token)
    + provider_not_found(title, token)
    + provider_not_given(title, token)
    + invalid_verification_code(title, token)
    + user_not_found(title, token)
    + missing_variable_in_body(title, token)
  }

  class BoilerplateIncoming {
    - database_link: SQL
    - boilerplate_non_http_initialised: BoilerplateNonHTTP
    - runtime_manager: RuntimeManager
    + __init__(error, success, debug)
    + token_correct(request)
    + logged_in(request)
    + get_token_if_present(request)
    + log_user_in(email)
    + log_user_out(token)
    + get_body(request)
    - _insert_login_into_database(user_data)
  }

  class BoilerplateNonHTTP {
    - database_link: SQL
    - runtime_manager: RuntimeManager
    + __init__(success, error, debug)
    + is_token_correct(token)
    + is_token_admin(token)
    + generate_token()
    + set_lifespan(seconds)
    + generate_check_token(token_size)
    + check_date(date)
    + hide_api_key(api_key)
    + update_single_data(table, column_finder, ...)
    + server_show_item_content(function_name, ...)
    + pause()
  }
}

package "Dependencies" {
  class SQL {
    + get_data_from_table()
    + insert_or_update_data_into_table()
    + update_data_in_table()
    + remove_data_from_table()
    + datetime_to_string()
  }

  class ServerHeaders {
    + for_json()
  }

  class HCI {
    + bad_request()
    + unauthorized()
    + forbidden()
    + not_found()
    + internal_server_error()
    + invalid_token()
  }

  class Constants {
    + JSON_TITLE
    + JSON_MESSAGE
    + JSON_RESP
    + JSON_ERROR
    + JSON_LOGGED_IN
    + REQUEST_TOKEN_KEY
    + REQUEST_BEARER_KEY
    + TAB_CONNECTIONS
    + TAB_ACCOUNTS
    + UA_TOKEN_LIFESPAN
  }
}

package "Core" {
  class RuntimeManager {
    + get(class_type)
    + get_if_exists(class_type, default)
  }

  class FinalSingleton {
    <<metaclass>>
  }
}

BoilerplateResponses --> HCI : creates HTTP responses
BoilerplateResponses --> ServerHeaders : adds headers
BoilerplateResponses --> BoilerplateNonHTTP : validates tokens
BoilerplateResponses --> RuntimeManager : retrieves instances
BoilerplateResponses ..|> FinalSingleton : metaclass
BoilerplateResponses --> Constants : uses JSON keys

BoilerplateIncoming --> SQL : queries database
BoilerplateIncoming --> BoilerplateNonHTTP : validates tokens
BoilerplateIncoming --> RuntimeManager : retrieves instances
BoilerplateIncoming --> Constants : uses table/column names

BoilerplateNonHTTP --> SQL : queries database
BoilerplateNonHTTP --> RuntimeManager : retrieves instances
BoilerplateNonHTTP --> Constants : uses configuration

note right of BoilerplateResponses
  Singleton pattern ensures
  consistent response formatting
  across all endpoints
end note

note bottom of BoilerplateNonHTTP
  Utility functions shared by
  both HTTP and non-HTTP contexts
end note

@enduml
