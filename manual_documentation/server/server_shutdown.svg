<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="2750px" preserveAspectRatio="none" style="width:2341px;height:2750px;background:#FFFFFF;" version="1.1" viewBox="0 0 2341 2750" width="2341px" zoomAndPan="magnify"><defs/><g><g><title>Server</title><rect fill="#FFFFFF" height="2456.0938" style="stroke:#000000;stroke-width:1;" width="10" x="254.7261" y="83.7266"/></g><g><title>Server</title><rect fill="#FFFFFF" height="2296.2969" style="stroke:#000000;stroke-width:1;" width="10" x="259.7261" y="243.5234"/></g><g><title>Server</title><rect fill="#FFFFFF" height="1932.9688" style="stroke:#000000;stroke-width:1;" width="10" x="264.7261" y="327.7891"/></g><g><title>Server</title><rect fill="#FFFFFF" height="186.6641" style="stroke:#000000;stroke-width:1;" width="10" x="264.7261" y="2289.8906"/></g><g><title>ServerManagement</title><rect fill="#FFFFFF" height="1859.7031" style="stroke:#000000;stroke-width:1;" width="10" x="600.8682" y="386.0547"/></g><g><title>BackgroundTasks</title><rect fill="#FFFFFF" height="657.5234" style="stroke:#000000;stroke-width:1;" width="10" x="950.9961" y="1567.1016"/></g><g><title>Crons</title><rect fill="#FFFFFF" height="236.0625" style="stroke:#000000;stroke-width:1;" width="10" x="1238.4199" y="1733.7656"/></g><g><title>Crons</title><rect fill="#FFFFFF" height="113.3984" style="stroke:#000000;stroke-width:1;" width="10" x="1238.4199" y="2348.1563"/></g><g><title>RuntimeControl</title><rect fill="#FFFFFF" height="29.1328" style="stroke:#000000;stroke-width:1;" width="10" x="1491.0142" y="457.3203"/></g><g><title>RuntimeControl</title><rect fill="#FFFFFF" height="71.2656" style="stroke:#000000;stroke-width:1;" width="10" x="1491.0142" y="804.9141"/></g><g><title>RuntimeControl</title><rect fill="#FFFFFF" height="29.1328" style="stroke:#000000;stroke-width:1;" width="10" x="1491.0142" y="905.3125"/></g><g><title>RuntimeControl</title><rect fill="#FFFFFF" height="536.2578" style="stroke:#000000;stroke-width:1;" width="10" x="1491.0142" y="987.7109"/></g><g><title>SQL</title><rect fill="#FFFFFF" height="155.5313" style="stroke:#000000;stroke-width:1;" width="10" x="1642.4585" y="539.7188"/></g><g><title>Uvicorn</title><rect fill="#FFFFFF" height="435.8594" style="stroke:#000000;stroke-width:1;" width="10" x="1868.8433" y="1016.8438"/></g><g><title>FastAPI</title><rect fill="#FFFFFF" height="155.5313" style="stroke:#000000;stroke-width:1;" width="10" x="2052.6733" y="1141.6406"/></g><rect fill="#FFFFFF" height="1905.9688" style="stroke:#000000;stroke-width:1;" width="2126.1587" x="209.771" y="347.7891"/><rect fill="#FFFFFF" height="1037.5156" style="stroke:#000000;stroke-width:1;" width="1826.1284" x="499.8013" y="501.4531"/><rect fill="#FFFFFF" height="582.5234" style="stroke:#000000;stroke-width:1;" width="1806.1284" x="509.8013" y="949.4453"/><rect fill="#FFFFFF" height="635.5234" style="stroke:#000000;stroke-width:1;" width="986.2129" x="509.8013" y="1582.1016"/><rect fill="#FFFFFF" height="159.6641" style="stroke:#000000;stroke-width:1;" width="1266.1528" x="209.771" y="2309.8906"/><g><title>Signal Handler</title><rect fill="#000000" fill-opacity="0.00000" height="2646.2891" width="8" x="85.8633" y="52.5938"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:5,5;" x1="89" x2="89" y1="52.5938" y2="2698.8828"/></g><g><title>Server</title><rect fill="#000000" fill-opacity="0.00000" height="2646.2891" width="8" x="255.7261" y="52.5938"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:5,5;" x1="258.771" x2="258.771" y1="52.5938" y2="2698.8828"/></g><g><title>ServerManagement</title><rect fill="#000000" fill-opacity="0.00000" height="2646.2891" width="8" x="601.8682" y="52.5938"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:5,5;" x1="605.8013" x2="605.8013" y1="52.5938" y2="2698.8828"/></g><g><title>BackgroundTasks</title><rect fill="#000000" fill-opacity="0.00000" height="2646.2891" width="8" x="951.9961" y="52.5938"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:5,5;" x1="955.1685" x2="955.1685" y1="52.5938" y2="2698.8828"/></g><g><title>Crons</title><rect fill="#000000" fill-opacity="0.00000" height="2646.2891" width="8" x="1239.4199" y="52.5938"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:5,5;" x1="1243.2881" x2="1243.2881" y1="52.5938" y2="2698.8828"/></g><g><title>RuntimeControl</title><rect fill="#000000" fill-opacity="0.00000" height="2646.2891" width="8" x="1492.0142" y="52.5938"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:5,5;" x1="1496.0054" x2="1496.0054" y1="52.5938" y2="2698.8828"/></g><g><title>SQL</title><rect fill="#000000" fill-opacity="0.00000" height="2646.2891" width="8" x="1643.4585" y="52.5938"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:5,5;" x1="1646.6055" x2="1646.6055" y1="52.5938" y2="2698.8828"/></g><g><title>Uvicorn</title><rect fill="#000000" fill-opacity="0.00000" height="2646.2891" width="8" x="1869.8433" y="52.5938"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:5,5;" x1="1873.1865" x2="1873.1865" y1="52.5938" y2="2698.8828"/></g><g><title>FastAPI</title><rect fill="#000000" fill-opacity="0.00000" height="2646.2891" width="8" x="2053.6733" y="52.5938"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:5,5;" x1="2056.8916" x2="2056.8916" y1="52.5938" y2="2698.8828"/></g><g class="participant participant-head" data-participant="Signal"><rect fill="#FFFFFF" height="46.5938" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="139.7266" x="20" y="5"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="102.5801" x="38.5732" y="24.9951">Signal Handler</text><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="125.7266" x="27" y="41.292">(SIGTERM/SIGINT)</text></g><g class="participant participant-tail" data-participant="Signal"><rect fill="#FFFFFF" height="46.5938" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="139.7266" x="20" y="2697.8828"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="102.5801" x="38.5732" y="2717.8779">Signal Handler</text><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="125.7266" x="27" y="2734.1748">(SIGTERM/SIGINT)</text></g><g class="participant participant-head" data-participant="Server"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="59.9102" x="229.771" y="21.2969"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="45.9102" x="236.771" y="41.292">Server</text></g><g class="participant participant-tail" data-participant="Server"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="59.9102" x="229.771" y="2697.8828"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="45.9102" x="236.771" y="2717.8779">Server</text></g><g class="participant participant-head" data-participant="SM"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="152.1338" x="529.8013" y="21.2969"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="138.1338" x="536.8013" y="41.292">ServerManagement</text></g><g class="participant participant-tail" data-participant="SM"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="152.1338" x="529.8013" y="2697.8828"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="138.1338" x="536.8013" y="2717.8779">ServerManagement</text></g><g class="participant participant-head" data-participant="BG"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="137.6553" x="887.1685" y="21.2969"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="123.6553" x="894.1685" y="41.292">BackgroundTasks</text></g><g class="participant participant-tail" data-participant="BG"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="137.6553" x="887.1685" y="2697.8828"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="123.6553" x="894.1685" y="2717.8779">BackgroundTasks</text></g><g class="participant participant-head" data-participant="Cron"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="54.2637" x="1216.2881" y="21.2969"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="40.2637" x="1223.2881" y="41.292">Crons</text></g><g class="participant participant-tail" data-participant="Cron"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="54.2637" x="1216.2881" y="2697.8828"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="40.2637" x="1223.2881" y="2717.8779">Crons</text></g><g class="participant participant-head" data-participant="RC"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="124.0176" x="1434.0054" y="21.2969"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="110.0176" x="1441.0054" y="41.292">RuntimeControl</text></g><g class="participant participant-tail" data-participant="RC"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="124.0176" x="1434.0054" y="2697.8828"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="110.0176" x="1441.0054" y="2717.8779">RuntimeControl</text></g><g class="participant participant-head" data-participant="SQL"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="41.7061" x="1626.6055" y="21.2969"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="27.7061" x="1633.6055" y="41.292">SQL</text></g><g class="participant participant-tail" data-participant="SQL"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="41.7061" x="1626.6055" y="2697.8828"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="27.7061" x="1633.6055" y="2717.8779">SQL</text></g><g class="participant participant-head" data-participant="Uvicorn"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="67.3135" x="1840.1865" y="21.2969"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="53.3135" x="1847.1865" y="41.292">Uvicorn</text></g><g class="participant participant-tail" data-participant="Uvicorn"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="67.3135" x="1840.1865" y="2697.8828"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="53.3135" x="1847.1865" y="2717.8779">Uvicorn</text></g><g class="participant participant-head" data-participant="FastAPI"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="65.5635" x="2024.8916" y="21.2969"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="51.5635" x="2031.8916" y="41.292">FastAPI</text></g><g class="participant participant-tail" data-participant="FastAPI"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="65.5635" x="2024.8916" y="2697.8828"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="51.5635" x="2031.8916" y="2717.8779">FastAPI</text></g><g><title>Server</title><rect fill="#FFFFFF" height="2456.0938" style="stroke:#000000;stroke-width:1;" width="10" x="254.7261" y="83.7266"/></g><g><title>Server</title><rect fill="#FFFFFF" height="2296.2969" style="stroke:#000000;stroke-width:1;" width="10" x="259.7261" y="243.5234"/></g><g><title>Server</title><rect fill="#FFFFFF" height="1932.9688" style="stroke:#000000;stroke-width:1;" width="10" x="264.7261" y="327.7891"/></g><g><title>Server</title><rect fill="#FFFFFF" height="186.6641" style="stroke:#000000;stroke-width:1;" width="10" x="264.7261" y="2289.8906"/></g><g><title>ServerManagement</title><rect fill="#FFFFFF" height="1859.7031" style="stroke:#000000;stroke-width:1;" width="10" x="600.8682" y="386.0547"/></g><g><title>BackgroundTasks</title><rect fill="#FFFFFF" height="657.5234" style="stroke:#000000;stroke-width:1;" width="10" x="950.9961" y="1567.1016"/></g><g><title>Crons</title><rect fill="#FFFFFF" height="236.0625" style="stroke:#000000;stroke-width:1;" width="10" x="1238.4199" y="1733.7656"/></g><g><title>Crons</title><rect fill="#FFFFFF" height="113.3984" style="stroke:#000000;stroke-width:1;" width="10" x="1238.4199" y="2348.1563"/></g><g><title>RuntimeControl</title><rect fill="#FFFFFF" height="29.1328" style="stroke:#000000;stroke-width:1;" width="10" x="1491.0142" y="457.3203"/></g><g><title>RuntimeControl</title><rect fill="#FFFFFF" height="71.2656" style="stroke:#000000;stroke-width:1;" width="10" x="1491.0142" y="804.9141"/></g><g><title>RuntimeControl</title><rect fill="#FFFFFF" height="29.1328" style="stroke:#000000;stroke-width:1;" width="10" x="1491.0142" y="905.3125"/></g><g><title>RuntimeControl</title><rect fill="#FFFFFF" height="536.2578" style="stroke:#000000;stroke-width:1;" width="10" x="1491.0142" y="987.7109"/></g><g><title>SQL</title><rect fill="#FFFFFF" height="155.5313" style="stroke:#000000;stroke-width:1;" width="10" x="1642.4585" y="539.7188"/></g><g><title>Uvicorn</title><rect fill="#FFFFFF" height="435.8594" style="stroke:#000000;stroke-width:1;" width="10" x="1868.8433" y="1016.8438"/></g><g><title>FastAPI</title><rect fill="#FFFFFF" height="155.5313" style="stroke:#000000;stroke-width:1;" width="10" x="2052.6733" y="1141.6406"/></g><g class="message" data-participant-1="Signal" data-participant-2="Server"><polygon fill="#000000" points="242.7261,79.7266,252.7261,83.7266,242.7261,87.7266,246.7261,83.7266" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="89.8633" x2="248.7261" y1="83.7266" y2="83.7266"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="120.9292" x="96.8633" y="78.6606">Destructor called (</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" text-decoration="underline" textLength="19.8618" x="217.7925" y="78.6606">del</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="5.0718" x="237.6543" y="78.6606">)</text></g><g class="message" data-participant-1="Server" data-participant-2="Server"><line style="stroke:#000000;stroke-width:1;" x1="264.7261" x2="306.7261" y1="112.8594" y2="112.8594"/><line style="stroke:#000000;stroke-width:1;" x1="306.7261" x2="306.7261" y1="112.8594" y2="125.8594"/><line style="stroke:#000000;stroke-width:1;" x1="265.7261" x2="306.7261" y1="125.8594" y2="125.8594"/><polygon fill="#000000" points="275.7261,121.8594,265.7261,125.8594,275.7261,129.8594,271.7261,125.8594" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="257.8037" x="271.7261" y="107.7935">log_info("The server is shutting down.")</text></g><path d="M269,138.8594 L269,208.8594 L471,208.8594 L471,148.8594 L461,138.8594 L269,138.8594" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><path d="M461,138.8594 L461,148.8594 L471,148.8594 L461,138.8594" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="157.7456" x="275" y="155.9263">Destructor triggered by:</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="181.1938" x="275" y="171.0591">- Process termination signal</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="166.2451" x="275" y="186.1919">- Server instance cleanup</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="109.9922" x="275" y="201.3247">- Application exit</text><g class="message" data-participant-1="Server" data-participant-2="Server"><line style="stroke:#000000;stroke-width:1;" x1="264.7261" x2="311.7261" y1="230.5234" y2="230.5234"/><line style="stroke:#000000;stroke-width:1;" x1="311.7261" x2="311.7261" y1="230.5234" y2="243.5234"/><line style="stroke:#000000;stroke-width:1;" x1="270.7261" x2="311.7261" y1="243.5234" y2="243.5234"/><polygon fill="#000000" points="280.7261,239.5234,270.7261,243.5234,280.7261,247.5234,276.7261,243.5234" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="85.8711" x="276.7261" y="225.4575">stop_server()</text></g><g class="message" data-participant-1="Server" data-participant-2="Server"><line style="stroke:#000000;stroke-width:1;" x1="269.7261" x2="311.7261" y1="277.6563" y2="277.6563"/><line style="stroke:#000000;stroke-width:1;" x1="311.7261" x2="311.7261" y1="277.6563" y2="290.6563"/><line style="stroke:#000000;stroke-width:1;" x1="270.7261" x2="311.7261" y1="290.6563" y2="290.6563"/><polygon fill="#000000" points="280.7261,286.6563,270.7261,290.6563,280.7261,294.6563,276.7261,290.6563" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="175.9951" x="276.7261" y="272.5903">log_info("Stopping server")</text></g><g class="message" data-participant-1="Server" data-participant-2="Server"><line style="stroke:#000000;stroke-width:1;" x1="269.7261" x2="316.7261" y1="314.7891" y2="314.7891"/><line style="stroke:#000000;stroke-width:1;" x1="316.7261" x2="316.7261" y1="314.7891" y2="327.7891"/><line style="stroke:#000000;stroke-width:1;" x1="275.7261" x2="316.7261" y1="327.7891" y2="327.7891"/><polygon fill="#000000" points="285.7261,323.7891,275.7261,327.7891,285.7261,331.7891,281.7261,327.7891" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="302.1421" x="281.7261" y="309.7231">Check if server_management_initialised exists</text></g><path d="M209.771,347.7891 L274.2139,347.7891 L274.2139,354.9219 L264.2139,364.9219 L209.771,364.9219 L209.771,347.7891" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><rect fill="none" height="1905.9688" style="stroke:#000000;stroke-width:1;" width="2126.1587" x="209.771" y="347.7891"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19.4429" x="224.771" y="360.856">alt</text><text fill="#000000" font-family="Verdana" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="243.7832" x="289.2139" y="359.9995">[server_management_initialised exists]</text><g class="message" data-participant-1="Server" data-participant-2="SM"><polygon fill="#000000" points="588.8682,382.0547,598.8682,386.0547,588.8682,390.0547,592.8682,386.0547" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="274.7261" x2="594.8682" y1="386.0547" y2="386.0547"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" text-decoration="underline" textLength="19.8618" x="281.7261" y="380.9888">del</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="90.4414" x="301.5879" y="380.9888">() via deletion</text></g><g class="message" data-participant-1="SM" data-participant-2="SM"><line style="stroke:#000000;stroke-width:1;" x1="610.8682" x2="652.8682" y1="415.1875" y2="415.1875"/><line style="stroke:#000000;stroke-width:1;" x1="652.8682" x2="652.8682" y1="415.1875" y2="428.1875"/><line style="stroke:#000000;stroke-width:1;" x1="611.8682" x2="652.8682" y1="428.1875" y2="428.1875"/><polygon fill="#000000" points="621.8682,424.1875,611.8682,428.1875,621.8682,432.1875,617.8682,428.1875" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="308.8643" x="617.8682" y="410.1216">log_info("Server sub processes shutting down")</text></g><g class="message" data-participant-1="SM" data-participant-2="RC"><polygon fill="#000000" points="1479.0142,453.3203,1489.0142,457.3203,1479.0142,461.3203,1483.0142,457.3203" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="610.8682" x2="1485.0142" y1="457.3203" y2="457.3203"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="105.5615" x="617.8682" y="452.2544">is_server_alive()</text></g><g class="message" data-participant-1="RC" data-participant-2="SM"><polygon fill="#000000" points="621.8682,482.4531,611.8682,486.4531,621.8682,490.4531,617.8682,486.4531" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="615.8682" x2="1495.0142" y1="486.4531" y2="486.4531"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="172.7642" x="627.8682" y="481.3872">continue_running == True</text></g><path d="M499.8013,501.4531 L564.2441,501.4531 L564.2441,508.5859 L554.2441,518.5859 L499.8013,518.5859 L499.8013,501.4531" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><rect fill="none" height="1037.5156" style="stroke:#000000;stroke-width:1;" width="1826.1284" x="499.8013" y="501.4531"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19.4429" x="514.8013" y="514.52">alt</text><text fill="#000000" font-family="Verdana" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="98.4897" x="579.2441" y="513.6636">[Server is alive]</text><g class="message" data-participant-1="SM" data-participant-2="SQL"><polygon fill="#000000" points="1630.4585,535.7188,1640.4585,539.7188,1630.4585,543.7188,1634.4585,539.7188" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="610.8682" x2="1636.4585" y1="539.7188" y2="539.7188"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" text-decoration="underline" textLength="19.8618" x="617.8682" y="534.6528">del</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="90.4414" x="637.73" y="534.6528">() via deletion</text></g><g class="message" data-participant-1="SQL" data-participant-2="SQL"><line style="stroke:#000000;stroke-width:1;" x1="1652.4585" x2="1694.4585" y1="568.8516" y2="568.8516"/><line style="stroke:#000000;stroke-width:1;" x1="1694.4585" x2="1694.4585" y1="568.8516" y2="581.8516"/><line style="stroke:#000000;stroke-width:1;" x1="1653.4585" x2="1694.4585" y1="581.8516" y2="581.8516"/><polygon fill="#000000" points="1663.4585,577.8516,1653.4585,581.8516,1663.4585,585.8516,1659.4585,581.8516" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="137.2681" x="1659.4585" y="563.7856">Close all connections</text></g><g class="message" data-participant-1="SQL" data-participant-2="SQL"><line style="stroke:#000000;stroke-width:1;" x1="1652.4585" x2="1694.4585" y1="610.9844" y2="610.9844"/><line style="stroke:#000000;stroke-width:1;" x1="1694.4585" x2="1694.4585" y1="610.9844" y2="623.9844"/><line style="stroke:#000000;stroke-width:1;" x1="1653.4585" x2="1694.4585" y1="623.9844" y2="623.9844"/><polygon fill="#000000" points="1663.4585,619.9844,1653.4585,623.9844,1663.4585,627.9844,1659.4585,623.9844" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="192.3848" x="1659.4585" y="605.9185">Commit pending transactions</text></g><g class="message" data-participant-1="SQL" data-participant-2="SQL"><line style="stroke:#000000;stroke-width:1;" x1="1652.4585" x2="1694.4585" y1="653.1172" y2="653.1172"/><line style="stroke:#000000;stroke-width:1;" x1="1694.4585" x2="1694.4585" y1="653.1172" y2="666.1172"/><line style="stroke:#000000;stroke-width:1;" x1="1653.4585" x2="1694.4585" y1="666.1172" y2="666.1172"/><polygon fill="#000000" points="1663.4585,662.1172,1653.4585,666.1172,1663.4585,670.1172,1659.4585,666.1172" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="159.0405" x="1659.4585" y="648.0513">Release connection pool</text></g><g class="message" data-participant-1="SQL" data-participant-2="SM"><polygon fill="#000000" points="621.8682,691.25,611.8682,695.25,621.8682,699.25,617.8682,695.25" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="615.8682" x2="1646.4585" y1="695.25" y2="695.25"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="182.4697" x="627.8682" y="690.1841">Database cleanup complete</text></g><path d="M1652,708.25 L1652,778.25 L1817,778.25 L1817,718.25 L1807,708.25 L1652,708.25" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><path d="M1807,708.25 L1807,718.25 L1817,718.25 L1807,708.25" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="121.9956" x="1658" y="725.3169">Database cleanup:</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="126.769" x="1658" y="740.4497">- Close connections</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="144.2314" x="1658" y="755.5825">- Commit transactions</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="127.9053" x="1658" y="770.7153">- Release resources</text><g class="message" data-participant-1="SM" data-participant-2="RC"><polygon fill="#000000" points="1479.0142,800.9141,1489.0142,804.9141,1479.0142,808.9141,1483.0142,804.9141" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="610.8682" x2="1485.0142" y1="804.9141" y2="804.9141"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="166.1753" x="617.8682" y="799.8481">continue_running = False</text></g><g class="message" data-participant-1="RC" data-participant-2="RC"><line style="stroke:#000000;stroke-width:1;" x1="1501.0142" x2="1543.0142" y1="834.0469" y2="834.0469"/><line style="stroke:#000000;stroke-width:1;" x1="1543.0142" x2="1543.0142" y1="834.0469" y2="847.0469"/><line style="stroke:#000000;stroke-width:1;" x1="1502.0142" x2="1543.0142" y1="847.0469" y2="847.0469"/><polygon fill="#000000" points="1512.0142,843.0469,1502.0142,847.0469,1512.0142,851.0469,1508.0142,847.0469" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="117.4443" x="1508.0142" y="828.981">Set shutdown flag</text></g><g class="message" data-participant-1="RC" data-participant-2="SM"><polygon fill="#000000" points="621.8682,872.1797,611.8682,876.1797,621.8682,880.1797,617.8682,876.1797" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="615.8682" x2="1495.0142" y1="876.1797" y2="876.1797"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="51.3081" x="627.8682" y="871.1138">Flag set</text></g><g class="message" data-participant-1="SM" data-participant-2="RC"><polygon fill="#000000" points="1479.0142,901.3125,1489.0142,905.3125,1479.0142,909.3125,1483.0142,905.3125" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="610.8682" x2="1485.0142" y1="905.3125" y2="905.3125"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="175.5825" x="617.8682" y="900.2466">Check if server is not None</text></g><g class="message" data-participant-1="RC" data-participant-2="SM"><polygon fill="#000000" points="621.8682,930.4453,611.8682,934.4453,621.8682,938.4453,617.8682,934.4453" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="615.8682" x2="1495.0142" y1="934.4453" y2="934.4453"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="142.4351" x="627.8682" y="929.3794">server instance exists</text></g><path d="M509.8013,949.4453 L574.2441,949.4453 L574.2441,956.5781 L564.2441,966.5781 L509.8013,966.5781 L509.8013,949.4453" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><rect fill="none" height="582.5234" style="stroke:#000000;stroke-width:1;" width="1806.1284" x="509.8013" y="949.4453"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19.4429" x="524.8013" y="962.5122">alt</text><text fill="#000000" font-family="Verdana" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="147.8984" x="589.2441" y="961.6558">[Server instance exists]</text><g class="message" data-participant-1="SM" data-participant-2="RC"><polygon fill="#000000" points="1479.0142,983.7109,1489.0142,987.7109,1479.0142,991.7109,1483.0142,987.7109" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="610.8682" x2="1485.0142" y1="987.7109" y2="987.7109"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="133.2056" x="617.8682" y="982.645">graceful_shutdown()</text></g><g class="message" data-participant-1="RC" data-participant-2="Uvicorn"><polygon fill="#000000" points="1856.8433,1012.8438,1866.8433,1016.8438,1856.8433,1020.8438,1860.8433,1016.8438" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="1501.0142" x2="1862.8433" y1="1016.8438" y2="1016.8438"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="170.2822" x="1508.0142" y="1011.7778">Initiate graceful shutdown</text></g><path d="M1883,1029.8438 L1883,1114.8438 L2158,1114.8438 L2158,1039.8438 L2148,1029.8438 L1883,1029.8438" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><path d="M2148,1029.8438 L2148,1039.8438 L2158,1039.8438 L2148,1029.8438" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="181.27" x="1889" y="1046.9106">Graceful shutdown process:</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="205.5435" x="1889" y="1062.0435">1. Stop accepting new requests</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="254.3633" x="1889" y="1077.1763">2. Wait for active requests to complete</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="205.9624" x="1889" y="1092.3091">3. Close keep-alive connections</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="184.1772" x="1889" y="1107.4419">4. Shutdown worker threads</text><g class="message" data-participant-1="Uvicorn" data-participant-2="FastAPI"><polygon fill="#000000" points="2040.6733,1137.6406,2050.6733,1141.6406,2040.6733,1145.6406,2044.6733,1141.6406" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="1878.8433" x2="2046.6733" y1="1141.6406" y2="1141.6406"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="142.2065" x="1885.8433" y="1136.5747">Finish active requests</text></g><g class="message" data-participant-1="FastAPI" data-participant-2="FastAPI"><line style="stroke:#000000;stroke-width:1;" x1="2062.6733" x2="2104.6733" y1="1170.7734" y2="1170.7734"/><line style="stroke:#000000;stroke-width:1;" x1="2104.6733" x2="2104.6733" y1="1170.7734" y2="1183.7734"/><line style="stroke:#000000;stroke-width:1;" x1="2063.6733" x2="2104.6733" y1="1183.7734" y2="1183.7734"/><polygon fill="#000000" points="2073.6733,1179.7734,2063.6733,1183.7734,2073.6733,1187.7734,2069.6733,1183.7734" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="177.3218" x="2069.6733" y="1165.7075">Complete in-flight requests</text></g><g class="message" data-participant-1="FastAPI" data-participant-2="FastAPI"><line style="stroke:#000000;stroke-width:1;" x1="2062.6733" x2="2104.6733" y1="1212.9063" y2="1212.9063"/><line style="stroke:#000000;stroke-width:1;" x1="2104.6733" x2="2104.6733" y1="1212.9063" y2="1225.9063"/><line style="stroke:#000000;stroke-width:1;" x1="2063.6733" x2="2104.6733" y1="1225.9063" y2="1225.9063"/><polygon fill="#000000" points="2073.6733,1221.9063,2063.6733,1225.9063,2073.6733,1229.9063,2069.6733,1225.9063" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="194.7842" x="2069.6733" y="1207.8403">Run shutdown event handlers</text></g><g class="message" data-participant-1="FastAPI" data-participant-2="FastAPI"><line style="stroke:#000000;stroke-width:1;" x1="2062.6733" x2="2104.6733" y1="1255.0391" y2="1255.0391"/><line style="stroke:#000000;stroke-width:1;" x1="2104.6733" x2="2104.6733" y1="1255.0391" y2="1268.0391"/><line style="stroke:#000000;stroke-width:1;" x1="2063.6733" x2="2104.6733" y1="1268.0391" y2="1268.0391"/><polygon fill="#000000" points="2073.6733,1264.0391,2063.6733,1268.0391,2073.6733,1272.0391,2069.6733,1268.0391" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="224.2563" x="2069.6733" y="1249.9731">Close SSE/WebSocket connections</text></g><g class="message" data-participant-1="FastAPI" data-participant-2="Uvicorn"><polygon fill="#000000" points="1889.8433,1293.1719,1879.8433,1297.1719,1889.8433,1301.1719,1885.8433,1297.1719" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="1883.8433" x2="2056.6733" y1="1297.1719" y2="1297.1719"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="149.8301" x="1895.8433" y="1292.106">All requests completed</text></g><g class="message" data-participant-1="Uvicorn" data-participant-2="Uvicorn"><line style="stroke:#000000;stroke-width:1;" x1="1878.8433" x2="1920.8433" y1="1326.3047" y2="1326.3047"/><line style="stroke:#000000;stroke-width:1;" x1="1920.8433" x2="1920.8433" y1="1326.3047" y2="1339.3047"/><line style="stroke:#000000;stroke-width:1;" x1="1879.8433" x2="1920.8433" y1="1339.3047" y2="1339.3047"/><polygon fill="#000000" points="1889.8433,1335.3047,1879.8433,1339.3047,1889.8433,1343.3047,1885.8433,1339.3047" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="127.3276" x="1885.8433" y="1321.2388">Close server socket</text></g><g class="message" data-participant-1="Uvicorn" data-participant-2="Uvicorn"><line style="stroke:#000000;stroke-width:1;" x1="1878.8433" x2="1920.8433" y1="1368.4375" y2="1368.4375"/><line style="stroke:#000000;stroke-width:1;" x1="1920.8433" x2="1920.8433" y1="1368.4375" y2="1381.4375"/><line style="stroke:#000000;stroke-width:1;" x1="1879.8433" x2="1920.8433" y1="1381.4375" y2="1381.4375"/><polygon fill="#000000" points="1889.8433,1377.4375,1879.8433,1381.4375,1889.8433,1385.4375,1885.8433,1381.4375" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="147.6338" x="1885.8433" y="1363.3716">Stop worker processes</text></g><g class="message" data-participant-1="Uvicorn" data-participant-2="Uvicorn"><line style="stroke:#000000;stroke-width:1;" x1="1878.8433" x2="1920.8433" y1="1410.5703" y2="1410.5703"/><line style="stroke:#000000;stroke-width:1;" x1="1920.8433" x2="1920.8433" y1="1410.5703" y2="1423.5703"/><line style="stroke:#000000;stroke-width:1;" x1="1879.8433" x2="1920.8433" y1="1423.5703" y2="1423.5703"/><polygon fill="#000000" points="1889.8433,1419.5703,1879.8433,1423.5703,1889.8433,1427.5703,1885.8433,1423.5703" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="127.2261" x="1885.8433" y="1405.5044">Release bound port</text></g><g class="message" data-participant-1="Uvicorn" data-participant-2="RC"><polygon fill="#000000" points="1512.0142,1448.7031,1502.0142,1452.7031,1512.0142,1456.7031,1508.0142,1452.7031" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="1506.0142" x2="1872.8433" y1="1452.7031" y2="1452.7031"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="129.7588" x="1518.0142" y="1447.6372">Shutdown complete</text></g><g class="message" data-participant-1="RC" data-participant-2="RC"><line style="stroke:#000000;stroke-width:1;" x1="1501.0142" x2="1543.0142" y1="1481.8359" y2="1481.8359"/><line style="stroke:#000000;stroke-width:1;" x1="1543.0142" x2="1543.0142" y1="1481.8359" y2="1494.8359"/><line style="stroke:#000000;stroke-width:1;" x1="1502.0142" x2="1543.0142" y1="1494.8359" y2="1494.8359"/><polygon fill="#000000" points="1512.0142,1490.8359,1502.0142,1494.8359,1512.0142,1498.8359,1508.0142,1494.8359" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="94.2246" x="1508.0142" y="1476.77">server = None</text></g><g class="message" data-participant-1="RC" data-participant-2="SM"><polygon fill="#000000" points="621.8682,1519.9688,611.8682,1523.9688,621.8682,1527.9688,617.8682,1523.9688" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="615.8682" x2="1495.0142" y1="1523.9688" y2="1523.9688"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="118.5996" x="627.8682" y="1518.9028">Server cleaned up</text></g><g class="message" data-participant-1="SM" data-participant-2="BG"><polygon fill="#000000" points="938.9961,1563.1016,948.9961,1567.1016,938.9961,1571.1016,942.9961,1567.1016" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="610.8682" x2="944.9961" y1="1567.1016" y2="1567.1016"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="321.1279" x="617.8682" y="1562.0356">Check if background_tasks_initialised is not None</text></g><path d="M509.8013,1582.1016 L574.2441,1582.1016 L574.2441,1589.2344 L564.2441,1599.2344 L509.8013,1599.2344 L509.8013,1582.1016" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><rect fill="none" height="635.5234" style="stroke:#000000;stroke-width:1;" width="986.2129" x="509.8013" y="1582.1016"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19.4429" x="524.8013" y="1595.1685">alt</text><text fill="#000000" font-family="Verdana" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="154.9722" x="589.2441" y="1594.312">[Background tasks exist]</text><g class="message" data-participant-1="SM" data-participant-2="BG"><polygon fill="#000000" points="938.9961,1616.3672,948.9961,1620.3672,938.9961,1624.3672,942.9961,1620.3672" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="610.8682" x2="944.9961" y1="1620.3672" y2="1620.3672"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" text-decoration="underline" textLength="19.8618" x="617.8682" y="1615.3013">del</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="90.4414" x="637.73" y="1615.3013">() via deletion</text></g><g class="message" data-participant-1="BG" data-participant-2="BG"><line style="stroke:#000000;stroke-width:1;" x1="960.9961" x2="1002.9961" y1="1649.5" y2="1649.5"/><line style="stroke:#000000;stroke-width:1;" x1="1002.9961" x2="1002.9961" y1="1649.5" y2="1662.5"/><line style="stroke:#000000;stroke-width:1;" x1="961.9961" x2="1002.9961" y1="1662.5" y2="1662.5"/><polygon fill="#000000" points="971.9961,1658.5,961.9961,1662.5,971.9961,1666.5,967.9961,1662.5" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="166.6704" x="967.9961" y="1644.4341">Stop accepting new tasks</text></g><g class="message" data-participant-1="BG" data-participant-2="BG"><line style="stroke:#000000;stroke-width:1;" x1="960.9961" x2="1002.9961" y1="1691.6328" y2="1691.6328"/><line style="stroke:#000000;stroke-width:1;" x1="1002.9961" x2="1002.9961" y1="1691.6328" y2="1704.6328"/><line style="stroke:#000000;stroke-width:1;" x1="961.9961" x2="1002.9961" y1="1704.6328" y2="1704.6328"/><polygon fill="#000000" points="971.9961,1700.6328,961.9961,1704.6328,971.9961,1708.6328,967.9961,1704.6328" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="192.061" x="967.9961" y="1686.5669">Signal worker threads to stop</text></g><g class="message" data-participant-1="BG" data-participant-2="Cron"><polygon fill="#000000" points="1226.4199,1729.7656,1236.4199,1733.7656,1226.4199,1737.7656,1230.4199,1733.7656" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="960.9961" x2="1232.4199" y1="1733.7656" y2="1733.7656"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="97.2905" x="967.9961" y="1728.6997">Stop scheduler</text></g><g class="message" data-participant-1="Cron" data-participant-2="Cron"><line style="stroke:#000000;stroke-width:1;" x1="1248.4199" x2="1290.4199" y1="1762.8984" y2="1762.8984"/><line style="stroke:#000000;stroke-width:1;" x1="1290.4199" x2="1290.4199" y1="1762.8984" y2="1775.8984"/><line style="stroke:#000000;stroke-width:1;" x1="1249.4199" x2="1290.4199" y1="1775.8984" y2="1775.8984"/><polygon fill="#000000" points="1259.4199,1771.8984,1249.4199,1775.8984,1259.4199,1779.8984,1255.4199,1775.8984" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="164.728" x="1255.4199" y="1757.8325">Cancel all scheduled jobs</text></g><g class="message" data-participant-1="Cron" data-participant-2="Cron"><line style="stroke:#000000;stroke-width:1;" x1="1248.4199" x2="1290.4199" y1="1805.0313" y2="1805.0313"/><line style="stroke:#000000;stroke-width:1;" x1="1290.4199" x2="1290.4199" y1="1805.0313" y2="1818.0313"/><line style="stroke:#000000;stroke-width:1;" x1="1249.4199" x2="1290.4199" y1="1818.0313" y2="1818.0313"/><polygon fill="#000000" points="1259.4199,1814.0313,1249.4199,1818.0313,1259.4199,1822.0313,1255.4199,1818.0313" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="218.5942" x="1255.4199" y="1799.9653">Wait for running jobs to complete</text></g><g class="message" data-participant-1="Cron" data-participant-2="Cron"><line style="stroke:#000000;stroke-width:1;" x1="1248.4199" x2="1290.4199" y1="1847.1641" y2="1847.1641"/><line style="stroke:#000000;stroke-width:1;" x1="1290.4199" x2="1290.4199" y1="1847.1641" y2="1860.1641"/><line style="stroke:#000000;stroke-width:1;" x1="1249.4199" x2="1290.4199" y1="1860.1641" y2="1860.1641"/><polygon fill="#000000" points="1259.4199,1856.1641,1249.4199,1860.1641,1259.4199,1864.1641,1255.4199,1860.1641" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="211.5737" x="1255.4199" y="1842.0981">Shutdown scheduler thread pool</text></g><path d="M1253,1873.1641 L1253,1943.1641 L1469,1943.1641 L1469,1883.1641 L1459,1873.1641 L1253,1873.1641" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><path d="M1459,1873.1641 L1459,1883.1641 L1469,1883.1641 L1459,1873.1641" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="102.5527" x="1259" y="1890.231">Cron shutdown:</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="140.5625" x="1259" y="1905.3638">- Cancel pending jobs</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="156.4951" x="1259" y="1920.4966">- Complete running jobs</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="195.6411" x="1259" y="1935.6294">- Release scheduler resources</text><g class="message" data-participant-1="Cron" data-participant-2="BG"><polygon fill="#000000" points="971.9961,1965.8281,961.9961,1969.8281,971.9961,1973.8281,967.9961,1969.8281" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="965.9961" x2="1242.4199" y1="1969.8281" y2="1969.8281"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="121.7925" x="977.9961" y="1964.7622">Scheduler stopped</text></g><g class="message" data-participant-1="BG" data-participant-2="BG"><line style="stroke:#000000;stroke-width:1;" x1="960.9961" x2="1002.9961" y1="1998.9609" y2="1998.9609"/><line style="stroke:#000000;stroke-width:1;" x1="1002.9961" x2="1002.9961" y1="1998.9609" y2="2011.9609"/><line style="stroke:#000000;stroke-width:1;" x1="961.9961" x2="1002.9961" y1="2011.9609" y2="2011.9609"/><polygon fill="#000000" points="971.9961,2007.9609,961.9961,2011.9609,971.9961,2015.9609,967.9961,2011.9609" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="253.4238" x="967.9961" y="1993.895">Wait for workers to finish current tasks</text></g><g class="message" data-participant-1="BG" data-participant-2="BG"><line style="stroke:#000000;stroke-width:1;" x1="960.9961" x2="1002.9961" y1="2041.0938" y2="2041.0938"/><line style="stroke:#000000;stroke-width:1;" x1="1002.9961" x2="1002.9961" y1="2041.0938" y2="2054.0938"/><line style="stroke:#000000;stroke-width:1;" x1="961.9961" x2="1002.9961" y1="2054.0938" y2="2054.0938"/><polygon fill="#000000" points="971.9961,2050.0938,961.9961,2054.0938,971.9961,2058.0938,967.9961,2054.0938" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="145.6978" x="967.9961" y="2036.0278">Join all worker threads</text></g><g class="message" data-participant-1="BG" data-participant-2="BG"><line style="stroke:#000000;stroke-width:1;" x1="960.9961" x2="1002.9961" y1="2083.2266" y2="2083.2266"/><line style="stroke:#000000;stroke-width:1;" x1="1002.9961" x2="1002.9961" y1="2083.2266" y2="2096.2266"/><line style="stroke:#000000;stroke-width:1;" x1="961.9961" x2="1002.9961" y1="2096.2266" y2="2096.2266"/><polygon fill="#000000" points="971.9961,2092.2266,961.9961,2096.2266,971.9961,2100.2266,967.9961,2096.2266" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="110.354" x="967.9961" y="2078.1606">Clear task queue</text></g><g class="message" data-participant-1="BG" data-participant-2="BG"><line style="stroke:#000000;stroke-width:1;" x1="960.9961" x2="1002.9961" y1="2125.3594" y2="2125.3594"/><line style="stroke:#000000;stroke-width:1;" x1="1002.9961" x2="1002.9961" y1="2125.3594" y2="2138.3594"/><line style="stroke:#000000;stroke-width:1;" x1="961.9961" x2="1002.9961" y1="2138.3594" y2="2138.3594"/><polygon fill="#000000" points="971.9961,2134.3594,961.9961,2138.3594,971.9961,2142.3594,967.9961,2138.3594" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="198.0151" x="967.9961" y="2120.2935">Release thread pool resources</text></g><g class="message" data-participant-1="BG" data-participant-2="SM"><polygon fill="#000000" points="621.8682,2163.4922,611.8682,2167.4922,621.8682,2171.4922,617.8682,2167.4922" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="615.8682" x2="949.9961" y1="2167.4922" y2="2167.4922"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="172.8213" x="627.8682" y="2162.4263">Background tasks stopped</text></g><g class="message" data-participant-1="SM" data-participant-2="SM"><line style="stroke:#000000;stroke-width:1;" x1="610.8682" x2="652.8682" y1="2196.625" y2="2196.625"/><line style="stroke:#000000;stroke-width:1;" x1="652.8682" x2="652.8682" y1="2196.625" y2="2209.625"/><line style="stroke:#000000;stroke-width:1;" x1="611.8682" x2="652.8682" y1="2209.625" y2="2209.625"/><polygon fill="#000000" points="621.8682,2205.625,611.8682,2209.625,621.8682,2213.625,617.8682,2209.625" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="239.77" x="617.8682" y="2191.5591">background_tasks_initialised = None</text></g><g class="message" data-participant-1="SM" data-participant-2="Server"><polygon fill="#000000" points="285.7261,2241.7578,275.7261,2245.7578,285.7261,2249.7578,281.7261,2245.7578" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="279.7261" x2="604.8682" y1="2245.7578" y2="2245.7578"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="248.7075" x="291.7261" y="2240.6919">ServerManagement cleanup complete</text></g><g class="message" data-participant-1="Server" data-participant-2="Server"><line style="stroke:#000000;stroke-width:1;" x1="269.7261" x2="316.7261" y1="2276.8906" y2="2276.8906"/><line style="stroke:#000000;stroke-width:1;" x1="316.7261" x2="316.7261" y1="2276.8906" y2="2289.8906"/><line style="stroke:#000000;stroke-width:1;" x1="275.7261" x2="316.7261" y1="2289.8906" y2="2289.8906"/><polygon fill="#000000" points="285.7261,2285.8906,275.7261,2289.8906,285.7261,2293.8906,281.7261,2289.8906" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="202.8647" x="281.7261" y="2271.8247">Check if crons_initialised exists</text></g><path d="M209.771,2309.8906 L274.2139,2309.8906 L274.2139,2317.0234 L264.2139,2327.0234 L209.771,2327.0234 L209.771,2309.8906" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><rect fill="none" height="159.6641" style="stroke:#000000;stroke-width:1;" width="1266.1528" x="209.771" y="2309.8906"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19.4429" x="224.771" y="2322.9575">alt</text><text fill="#000000" font-family="Verdana" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="151.1909" x="289.2139" y="2322.1011">[crons_initialised exists]</text><g class="message" data-participant-1="Server" data-participant-2="Cron"><polygon fill="#000000" points="1226.4199,2344.1563,1236.4199,2348.1563,1226.4199,2352.1563,1230.4199,2348.1563" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="274.7261" x2="1232.4199" y1="2348.1563" y2="2348.1563"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" text-decoration="underline" textLength="19.8618" x="281.7261" y="2343.0903">del</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="90.4414" x="301.5879" y="2343.0903">() via deletion</text></g><g class="message" data-participant-1="Cron" data-participant-2="Cron"><line style="stroke:#000000;stroke-width:1;" x1="1248.4199" x2="1290.4199" y1="2377.2891" y2="2377.2891"/><line style="stroke:#000000;stroke-width:1;" x1="1290.4199" x2="1290.4199" y1="2377.2891" y2="2390.2891"/><line style="stroke:#000000;stroke-width:1;" x1="1249.4199" x2="1290.4199" y1="2390.2891" y2="2390.2891"/><polygon fill="#000000" points="1259.4199,2386.2891,1249.4199,2390.2891,1259.4199,2394.2891,1255.4199,2390.2891" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="198.5039" x="1255.4199" y="2372.2231">Shutdown remaining cron jobs</text></g><g class="message" data-participant-1="Cron" data-participant-2="Cron"><line style="stroke:#000000;stroke-width:1;" x1="1248.4199" x2="1290.4199" y1="2419.4219" y2="2419.4219"/><line style="stroke:#000000;stroke-width:1;" x1="1290.4199" x2="1290.4199" y1="2419.4219" y2="2432.4219"/><line style="stroke:#000000;stroke-width:1;" x1="1249.4199" x2="1290.4199" y1="2432.4219" y2="2432.4219"/><polygon fill="#000000" points="1259.4199,2428.4219,1249.4199,2432.4219,1259.4199,2436.4219,1255.4199,2432.4219" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="151.8994" x="1255.4199" y="2414.356">Release cron resources</text></g><g class="message" data-participant-1="Cron" data-participant-2="Server"><polygon fill="#000000" points="285.7261,2457.5547,275.7261,2461.5547,285.7261,2465.5547,281.7261,2461.5547" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="279.7261" x2="1242.4199" y1="2461.5547" y2="2461.5547"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="157.8281" x="291.7261" y="2456.4888">Crons cleanup complete</text></g><g class="message" data-participant-1="Server" data-participant-2="Server"><line style="stroke:#000000;stroke-width:1;" x1="269.7261" x2="311.7261" y1="2497.6875" y2="2497.6875"/><line style="stroke:#000000;stroke-width:1;" x1="311.7261" x2="311.7261" y1="2497.6875" y2="2510.6875"/><line style="stroke:#000000;stroke-width:1;" x1="270.7261" x2="311.7261" y1="2510.6875" y2="2510.6875"/><polygon fill="#000000" points="280.7261,2506.6875,270.7261,2510.6875,280.7261,2514.6875,276.7261,2510.6875" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="172.1421" x="276.7261" y="2492.6216">log_info("Server stopped")</text></g><g class="message" data-participant-1="Server" data-participant-2="Signal"><polygon fill="#000000" points="100.8633,2535.8203,90.8633,2539.8203,100.8633,2543.8203,96.8633,2539.8203" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="94.8633" x2="258.7261" y1="2539.8203" y2="2539.8203"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="129.7588" x="106.8633" y="2534.7544">Shutdown complete</text></g><path d="M226,2552.8203 L226,2683.8203 L1679,2683.8203 L1679,2562.8203 L1669,2552.8203 L226,2552.8203" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><path d="M1669,2552.8203 L1669,2562.8203 L1679,2562.8203 L1669,2552.8203" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="174.7954" x="777.6326" y="2569.8872">Cleanup order guarantees:</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="180.5273" x="777.6326" y="2585.02">1. Stop accepting new work</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="183.4409" x="777.6326" y="2600.1528">2. Complete active requests</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="165.6675" x="777.6326" y="2615.2856">3. Stop background tasks</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="198.8848" x="777.6326" y="2630.4185">4. Close database connections</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="154.9399" x="777.6326" y="2645.5513">5. Release all resources</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="4.1323" x="777.6326" y="2660.6841">&#160;</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="341.2754" x="777.6326" y="2675.8169">Result: Clean shutdown with no orphaned processes</text><!--SRC=[dLXRRzis57xNh-3oaWHONBJ9NWnqGEAcQOQuI6mFVHbWq19jSv59ZQIIxj_ly2fIekraUeaYdllbupd-HMt9Zg2cnfGLHOE5eYLjC5FeP4ut3DVe6sPLJSHVx6n-VxUudKq_mD_xxulp4uGbiaGzHY9UYB37vZLtFCKCRq0rKvPmcXBTuF9v8tZBgWMMpzBGtDobD1F1cJtHR-dPh6MAxiY4CoLuROXcavuTJmzMzTD3Ul3d2osvOERGlQS4Nx5Kru_tXi2z5yKf-ZnuqEEtw_aj-ZX6ysshAlxAq4BGpOQ8377X0dxnkmlR67qXKecsL5oW4jSrgT3PSbcHUhayBt2fw0jMnCUui7zZzfflbfIj-Td9OakGjETK8Wd6ACesI5iqEZal2iP145YsLOYllKG4JsI1ifQ34Qj_n-Rm0ZqANX8faI9YHnbMb3CaRKbO0cSKPL9XLX9KrWIpjd6drqrJqzAoaPzK5OHLIDkIyqOgtYoj4sVlT7yEh8rssB9hZm-awzFOYA1WxiIQcytMGDzaIyfdHDTEot8NIXpCe8hYcag87ZWgbHmwW6lrDauTkqZxT8nSKPoTenUA4RmJ7L93sAcPclyjzzHpHZ6o4cMxGetDAkbL2eGjI3ZjUwlh2iny8P62sMGCdrtEbkRqx3or2ffI_p-Re0jdKGajIrbBbg9bJAk6l2n4Q-LMfCzfnK7evXapdAKrbmHLME4LXXTGm4Yf0oG3aGl8qyF1MARn1DW8x4yFWTzgWsxDAuef-Mv75MgWwBMVIc0cyG7w6TYIEe0QpkkKraNnI_3MLN39TmsuqiKb2cNiIdZfGK94Od2X9t-Sd5wuAEGYuCwjxrcVBONtLX39Mm7r6Cu3I0niFaMwqtr5hckywMLOL-Imm034Qqc6ANObvWlKii-9CcrXq3nH4HNnL_WEPgXSj2EfSP7ssyaZPjJqgH-P1eIeeE-S7NV5cNb4rn6ZuwxR8y7wTYTmITPj7UAMd7SURHpTqjCvj3ZaJM9HbobtRu_HlS5FuDaSD2A8zXV-NlbfN-J8zJDmsOFgU43wSMIh5fSbQGpOCl8APVzFI_gXrC-d4Vg1eNNMS2KRgqcWHOeF-zm_boFNbC-4D1S68_VsftwkHjtGyih5CsHPRGN1LKewQCP1m5o8T5RSi0Jz0TUQtFRjpsV4JrXx5JY2HC74XG4gys9TcsnbjUHuONRiqaPUu1P6Mpi47-Ur8PxFRp_y8AivBvy1BVP5EIyiBjvhk4L2SdrcguGlwj6ZWOeo4LHOWnqGI6FmKHvJhgucmgnmbCi3-afFzN1p2VK6Ipte-dHaopkAmT7sxO3S-VmvHSmUGZfyCxSSJ61kSZqCaD0IHVpN3qpk9bw5rGOflTj40zFDNGJh7TtIq2MZO1_iWnsm92LZqKrFcqNetdMYzHwPUyBBpPtdoA1Mvr2FrAusAOvekD93_Tvxl1HwdIYtf6fhjuzqOlNEvsmOaeHmcCrm85z_xMHCzCrLcv7DIwhGttmbzz07-FK3XARDOc_A5ueusEiYaOvnUoQmn9CWtEFKOFwoFldPCl4cJ60M8MClzinWdS7lcSQizxu2WWYTyYP2iQY9yjawxIBk2iW5EgxFhjPwn2OpQtlVbAqG6ixtbUaVd39J1tikl8vIDxCmSX30Sqio93vuKOupuKiO7UWCUhOVilxU0Zm7qIB2E0zAKTHZoD02evMs_rjDVfs8Lucftk6B-8jRRmyit9TZatdvFzTj3HFopIlsNkfqhROj-vR5EXHjSQ3b1TbXQjhCW5hejPGyR7ZwQrehHT9H8GOcRCUIOYnyVrgkp9m6iFskj0n_KR35gtzqyTIQtDm8kPjzQ6J6R8EDN0kpNtuD6wetbeiAJZSjXXLJ4U86x_omhTkzSCDrmCNSS7hfsBDt-DNes4yDlur2Yd5Tvp8y8xAjbSMNQ0fzfMeBA0jEDLipY7HZLy3V_m00]--></g></svg>